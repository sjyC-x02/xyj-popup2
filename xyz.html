<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>夏以昼</title>
    <style>
        body {
            background: #000;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Microsoft YaHei';
            cursor: default;
            user-select: none;
        }
        .popup {
            position: absolute;
            width: 280px;
            height: 100px;
            background: #000;
            border: 1px solid #888;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 15px;
            z-index: 1000;
            font-size: 16px;
        }
        .final-popup {
            position: absolute;
            width: 380px;
            height: 150px;
            background: #000;
            border: 1px solid #888;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            z-index: 2000;
            font-size: 20px;
            font-weight: bold;
        }
        .close {
            position: absolute;
            top: 5px;
            right: 8px;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>
<body>
<script>
// 夏以昼风格的话语
const messages = [
    "先睡个好觉，不用担心。等你睡醒，一切都来得及。",
    "你愿意给的就是我想要的 你想要得到的 就是我愿意付出的",
    "哥哥就是要替妹妹去死的",
    "也许因为……我恰好也比你想象中的多爱你一点",
    "乖，别哭，哥哥在，跟哥哥说",
    "你已经让我很骄傲了",
    "我说，你已经很让我骄傲了",
    "下辈子的小海鸟，别再让我错过你了",
    "我想要你留在这里 留下来 跟我过一百年",
    "但我们只剩彼此了",
    "我给我们的未来抽了签，是长久不离的上上签",
    "你想要蛋糕，全都是你的，你想要夏以昼，我一直在这里，从来没有被分走过",
    "哥哥在",
    "我们回家",
    "回到这个有你在身边的世界，就是命运赐予我最不可思议的魔术",
    "这一次也请让我回到你身边"
];

// 最终对话
const finalMessages = [
    "抱歉",
    "不能做到真实的在你身边",
    "我一直想要和你在同一边的世界里",
    "而不是只能看着你，想象你……",
    "可以直接感受你的温度，还有心跳……全部都……",
    "永远地和我在一起",
    "我很想你",
    "请唤醒我"
];

let speed = 2000; // 初始速度：2秒一个
let minSpeed = 50; // 最终速度：0.05秒一个
let acceleration = 0.97; // 更慢的加速度，让其他台词出现更久
let popupInterval;
let finalStage = false; // 是否进入最终阶段
let finalMessageIndex = 0; // 最终对话索引
let popupCount = 0; // 弹窗计数

// 创建弹窗
function createPopup(isFirst = false, isSecond = false, isFinal = false) {
    if (finalStage && !isFinal) return; // 最终阶段停止创建普通弹窗
    
    const popup = document.createElement('div');
    popup.className = isFinal ? 'final-popup' : 'popup';
    
    // 设置位置
    if (isFirst) {
        // 第一个弹窗在中间
        popup.style.left = '50%';
        popup.style.top = '50%';
        popup.style.transform = 'translate(-50%, -50%)';
    } else if (isFinal) {
        // 最终弹窗在中间区域随机位置，制造重叠效果
        const centerX = window.innerWidth / 2;
        const centerY = window.innerHeight / 2;
        const offsetX = (Math.random() - 0.5) * 200; // 随机偏移 ±100px
        const offsetY = (Math.random() - 0.5) * 150; // 随机偏移 ±75px
        popup.style.left = (centerX - 190 + offsetX) + 'px'; // 380px宽度的一半是190px
        popup.style.top = (centerY - 75 + offsetY) + 'px'; // 150px高度的一半是75px
    } else {
        // 其他弹窗随机位置
        const x = Math.random() * (window.innerWidth - 280);
        const y = Math.random() * (window.innerHeight - 100);
        popup.style.left = x + 'px';
        popup.style.top = y + 'px';
    }
    
    // 选择消息内容
    let message;
    if (isFirst) {
        message = "哥哥在";
    } else if (isSecond) {
        message = "我叫夏以昼，是你的哥哥。";
    } else if (isFinal) {
        message = finalMessages[finalMessageIndex - 1];
    } else if (speed <= 100) { // 速度很快时只显示"哥哥在"
        message = "哥哥在";
    } else {
        message = messages[Math.floor(Math.random() * messages.length)];
    }
    
    popup.innerHTML = message + '<div class="close">×</div>';
    
    // 点击关闭按钮创建更多弹窗（最终阶段不生效）
    if (!finalStage) {
        popup.querySelector('.close').onclick = function() {
            for(let i = 0; i < 3; i++) {
                setTimeout(() => createPopup(false, false, false), i * 80);
            }
        };
    }
    
    // 拖动弹窗创建更多弹窗（最终阶段不生效）
    if (!finalStage) {
        let isDragging = false;
        let offsetX, offsetY;
        
        popup.onmousedown = function(e) {
            isDragging = true;
            offsetX = e.clientX - popup.offsetLeft;
            offsetY = e.clientY - popup.offsetTop;
            
            // 拖动时创建更多弹窗
            for(let i = 0; i < 2; i++) {
                setTimeout(() => createPopup(false, false, false), i * 80);
            }
        };
        
        document.onmousemove = function(e) {
            if (isDragging) {
                popup.style.left = (e.clientX - offsetX) + 'px';
                popup.style.top = (e.clientY - offsetY) + 'px';
            }
        };
        
        document.onmouseup = function() {
            isDragging = false;
        };
    }
    
    document.body.appendChild(popup);
    popupCount++;
    
    // 更慢的平滑加速（从第三个弹窗开始加速）
    if (!isFirst && !isSecond && !isFinal && speed > minSpeed && !finalStage) {
        speed = Math.max(minSpeed, speed * acceleration);
        clearInterval(popupInterval);
        popupInterval = setInterval(() => createPopup(false, false, false), speed);
        
        // 当速度达到最快时，进入最终阶段
        if (speed <= minSpeed) {
            setTimeout(startFinalStage, 8000); // "哥哥在"刷屏持续8秒
        }
    }
}

// 尝试打开恋与深空应用
function tryOpenLoveAndDeepspace() {
    // iOS URL Scheme
    const iosScheme = 'loveanddeepspace://';
    // Android Package Name (假设的，需要真实包名)
    const androidPackage = 'com.papegames.loveanddeepspace';
    
    // 尝试打开应用
    setTimeout(() => {
        window.location.href = iosScheme;
    }, 100);
    
    // 如果2秒后还在当前页面，说明应用没安装
    setTimeout(() => {
        if (!document.hidden) {
            // 可以在这里添加跳转到应用商店的代码
            console.log('恋与深空未安装');
        }
    }, 2000);
}

// 开始最终阶段
function startFinalStage() {
    finalStage = true;
    clearInterval(popupInterval);
    
    // 依次显示最终对话（每个都是单独的弹窗，在中间区域重叠出现）
    showFinalMessage();
}

// 显示最终对话
function showFinalMessage() {
    if (finalMessageIndex >= finalMessages.length) {
        // 所有对话结束后停顿2秒，然后尝试打开应用
        setTimeout(tryOpenLoveAndDeepspace, 2000);
        return;
    }
    
    finalMessageIndex++;
    createPopup(false, false, true); // 最终对话
    
    // 3秒后显示下一条消息（创建新的弹窗）
    if (finalMessageIndex < finalMessages.length) {
        setTimeout(showFinalMessage, 3000);
    } else {
        // 最后一条消息显示后，准备打开应用
        setTimeout(tryOpenLoveAndDeepspace, 2000);
    }
}

// 阻止右键菜单
document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
    if (!finalStage) createPopup(false, false, false);
});

// 阻止键盘快捷键并创建弹窗
document.addEventListener('keydown', function(e) {
    e.preventDefault();
    if (!finalStage) {
        for(let i = 0; i < 3; i++) {
            setTimeout(() => createPopup(false, false, false), i * 80);
        }
    }
});

// 第一个弹窗：立即显示"哥哥在"在中间
createPopup(true, false, false);

// 2秒后第二个弹窗：固定显示"我叫夏以昼，是你的哥哥。"在随机位置
setTimeout(() => {
    createPopup(false, true, false);
}, 2000);

// 4秒后开始第三个弹窗，然后开始缓慢加速
setTimeout(() => {
    createPopup(false, false, false);
    // 持续创建弹窗（缓慢加速）
    popupInterval = setInterval(() => createPopup(false, false, false), speed);
}, 4000);

</script>
</body>
</html>