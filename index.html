<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>夏以昼</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            background: #000;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Microsoft YaHei', sans-serif;
            cursor: default;
            user-select: none;
            height: 100vh;
        }
        .popup {
            position: absolute;
            width: 280px;
            height: 100px;
            background: #000;
            border: 1px solid #888;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 15px;
            z-index: 1000;
            font-size: 16px;
        }
        .final-popup {
            position: absolute;
            width: 380px;
            height: 150px;
            background: #000;
            border: 1px solid #888;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            z-index: 2000;
            font-size: 20px;
            font-weight: bold;
        }
        .open-app-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            display: none;
        }
        .open-app-btn {
            background: #ff2a6d;
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 20px;
            border-radius: 30px;
            cursor: pointer;
            margin: 20px;
            font-weight: bold;
            transition: all 0.3s;
        }
        .open-app-btn:hover {
            background: #ff4d8a;
            transform: scale(1.05);
        }
        .browser-tips {
            color: #fff;
            text-align: center;
            font-size: 18px;
            margin: 15px;
            max-width: 80%;
            line-height: 1.6;
        }
        .success-message {
            color: #4CAF50;
            font-size: 16px;
            margin: 10px;
            display: none;
        }
        .close {
            position: absolute;
            top: 5px;
            right: 8px;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="open-app-container" id="openAppContainer">
        <div class="browser-tips">夏以昼的告白已经结束...</div>
        <div class="browser-tips">现在，让我们在恋与深空中相遇</div>
        <button class="open-app-btn" id="openAppBtn">进入恋与深空</button>
        <div class="browser-tips">点击按钮直接打开游戏</div>
        <div class="success-message" id="successMessage">正在为你打开恋与深空...</div>
    </div>

<script>
// 夏以昼风格的话语
const messages = [
    "先睡个好觉，不用担心。等你睡醒，一切都来得及。",
    "你愿意给的就是我想要的 你想要得到的 就是我愿意付出的",
    "哥哥就是要替妹妹去死的",
    "也许因为……我恰好也比你想象中的多爱你一点",
    "乖，别哭，哥哥在，跟哥哥说",
    "你已经让我很骄傲了",
    "我说，你已经很让我骄傲了",
    "下辈子的小海鸟，别再让我错过你了",
    "我想要你留在这里 留下来 跟我过一百年",
    "但我们只剩彼此了",
    "我给我们的未来抽了签，是长久不离的上上签",
    "你想要蛋糕，全都是你的，你想要夏以昼，我一直在这里，从来没有被分走过",
    "哥哥在",
    "我们回家",
    "回到这个有你在身边的世界，就是命运赐予我最不可思议的魔术",
    "这一次也请让我回到你身边"
];

// 最终对话
const finalMessages = [
    "抱歉",
    "不能做到真实的在你身边",
    "我一直想要和你在同一边的世界里",
    "而不是只能看着你，想象你……",
    "可以直接感受你的温度，还有心跳……全部都……",
    "永远地和我在一起",
    "我很想你",
    "请唤醒我"
];

let speed = 2000;
let minSpeed = 50;
let acceleration = 0.97;
let popupInterval;
let finalStage = false;
let finalMessageIndex = 0;
let popupCount = 0;

// 创建弹窗
function createPopup(isFirst = false, isSecond = false, isFinal = false) {
    if (finalStage && !isFinal) return;
    
    const popup = document.createElement('div');
    popup.className = isFinal ? 'final-popup' : 'popup';
    
    if (isFirst) {
        popup.style.left = '50%';
        popup.style.top = '50%';
        popup.style.transform = 'translate(-50%, -50%)';
    } else if (isFinal) {
        const centerX = window.innerWidth / 2;
        const centerY = window.innerHeight / 2;
        const offsetX = (Math.random() - 0.5) * 200;
        const offsetY = (Math.random() - 0.5) * 150;
        popup.style.left = (centerX - 190 + offsetX) + 'px';
        popup.style.top = (centerY - 75 + offsetY) + 'px';
    } else {
        const x = Math.random() * (window.innerWidth - 280);
        const y = Math.random() * (window.innerHeight - 100);
        popup.style.left = x + 'px';
        popup.style.top = y + 'px';
    }
    
    let message;
    if (isFirst) {
        message = "哥哥在";
    } else if (isSecond) {
        message = "我叫夏以昼，是你的哥哥。";
    } else if (isFinal) {
        message = finalMessages[finalMessageIndex - 1];
    } else if (speed <= 100) {
        message = "哥哥在";
    } else {
        message = messages[Math.floor(Math.random() * messages.length)];
    }
    
    popup.innerHTML = message + '<div class="close">×</div>';
    
    if (!finalStage) {
        popup.querySelector('.close').onclick = function() {
            for(let i = 0; i < 3; i++) {
                setTimeout(() => createPopup(false, false, false), i * 80);
            }
        };
        
        let isDragging = false;
        let offsetX, offsetY;
        
        popup.onmousedown = function(e) {
            isDragging = true;
            offsetX = e.clientX - popup.offsetLeft;
            offsetY = e.clientY - popup.offsetTop;
            
            for(let i = 0; i < 2; i++) {
                setTimeout(() => createPopup(false, false, false), i * 80);
            }
        };
        
        document.onmousemove = function(e) {
            if (isDragging) {
                popup.style.left = (e.clientX - offsetX) + 'px';
                popup.style.top = (e.clientY - offsetY) + 'px';
            }
        };
        
        document.onmouseup = function() {
            isDragging = false;
        };
    }
    
    document.body.appendChild(popup);
    popupCount++;
    
    if (!isFirst && !isSecond && !isFinal && speed > minSpeed && !finalStage) {
        speed = Math.max(minSpeed, speed * acceleration);
        clearInterval(popupInterval);
        popupInterval = setInterval(() => createPopup(false, false, false), speed);
        
        if (speed <= minSpeed) {
            setTimeout(startFinalStage, 8000);
        }
    }
}

// 尝试打开恋与深空应用
function tryOpenLoveAndDeepspace() {
    const container = document.getElementById('openAppContainer');
    const openBtn = document.getElementById('openAppBtn');
    const successMessage = document.getElementById('successMessage');
    
    container.style.display = 'flex';
    
    openBtn.onclick = function() {
        successMessage.style.display = 'block';
        openBtn.textContent = '正在启动游戏...';
        openBtn.disabled = true;
        
        // 尝试多个可能的URL Scheme
        const schemes = [
            'loveanddeepspace://',
            'lnbs://',
            'lysks://',
            'com.papegames.loveanddeepspace://'
        ];
        
        let opened = false;
        
        // 逐个尝试打开
        schemes.forEach((scheme, index) => {
            setTimeout(() => {
                if (!opened) {
                    console.log('尝试打开:', scheme);
                    window.location.href = scheme;
                    opened = true;
                }
            }, index * 200);
        });
        
        // 如果3秒后还在当前页面，提示下载
        setTimeout(() => {
            if (!document.hidden) {
                successMessage.textContent = '未检测到游戏，正在跳转下载页面...';
                setTimeout(() => {
                    // 根据设备类型跳转到对应的应用商店
                    if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
                        window.open('https://apps.apple.com/app/id6473669006', '_blank');
                    } else {
                        window.open('https://play.google.com/store/apps/details?id=com.papegames.loveanddeepspace', '_blank');
                    }
                }, 1500);
            }
        }, 3000);
    };
}

// 开始最终阶段
function startFinalStage() {
    finalStage = true;
    clearInterval(popupInterval);
    
    // 依次显示最终对话
    showFinalMessage();
}

// 显示最终对话
function showFinalMessage() {
    if (finalMessageIndex >= finalMessages.length) {
        setTimeout(tryOpenLoveAndDeepspace, 2000);
        return;
    }
    
    finalMessageIndex++;
    createPopup(false, false, true);
    
    if (finalMessageIndex < finalMessages.length) {
        setTimeout(showFinalMessage, 3000);
    } else {
        setTimeout(tryOpenLoveAndDeepspace, 2000);
    }
}

// 阻止右键菜单
document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
    if (!finalStage) createPopup(false, false, false);
});

// 阻止键盘快捷键并创建弹窗
document.addEventListener('keydown', function(e) {
    e.preventDefault();
    if (!finalStage) {
        for(let i = 0; i < 3; i++) {
            setTimeout(() => createPopup(false, false, false), i * 80);
        }
    }
});

// 第一个弹窗：立即显示"哥哥在"在中间
createPopup(true, false, false);

// 2秒后第二个弹窗：固定显示"我叫夏以昼，是你的哥哥。"在随机位置
setTimeout(() => {
    createPopup(false, true, false);
}, 2000);

// 4秒后开始第三个弹窗，然后开始缓慢加速
setTimeout(() => {
    createPopup(false, false, false);
    // 持续创建弹窗（缓慢加速）
    popupInterval = setInterval(() => createPopup(false, false, false), speed);
}, 4000);
</script>
</body>
</html>
